### План: Открытие `archi-mcp-plugin` в OSS (feature-plan 12)

## Цель
- Подготовить репозиторий к публичному открытию: лицензирование, юридическая чистота, структура OSS‑проекта, CI и шаблоны участия.

## Контекст/Предпосылки
- Java 17; Archi 5.x; локальный REST/MCP API.
- Документация: `README.md`, `AGENTS.md`, `TEST_INSTRUCTIONS.md`.
- Тесты размещены под `ru.cinimex.archimatetool.mcp/test` [[memory:5587551]].
- Вендорные артефакты: `ru.cinimex.archimatetool.mcp/lib/jackson-*.jar` (Apache‑2.0), `ru.cinimex.archimatetool.mcp/lib/Archi-5.6.0.zip` (не следует публиковать).
- Источник правды по REST — `resources/openapi.json`; описания MCP‑инструментов синхронизируются в `archi-mcp-server/server.py`.

## Инварианты
- Слушаем только `127.0.0.1`; без сетевой аутентификации (локальный сервис).
- Совместимость REST и legacy‑путей.
- Любые изменения EMF‑модели — через `Display.getDefault().syncExec(...)`.
- Не коммитим чужие бинарники; лицензии сторонних зависимостей явно указаны.

## Целевая архитектура 
- Репозиторий без чужих бинарников; чёткая лицензия и NOTICE.
- CI (GitHub Actions): Java 17, JUnit; кэш зависимостей; артефакты логов.
- Шаблоны участия и правила: `CONTRIBUTING`, `CODE_OF_CONDUCT`, `SECURITY`, `CODEOWNERS`, ISSUE/PR templates.
- По возможности: сборка через Tycho/p2 (или вынести в отдельную фичу).

## Ведение прогресса по шагам (скопировать в план целиком)
- Для каждого шага поддерживать чек‑лист:
  - Статус: [done|partial|todo]
  - Сделано: краткий перечень завершённых подпунктов
  - Осталось: оставшиеся подпункты/блокеры/владелец (если есть)
- Если шаг выполнен, агент сразу переходит к следующему до полного завершения плана.

## Шаги реализации
⚠️ Важно: все шаги должны выполняться последовательно и без остановок, пока не завершится весь план. Если после выполнения одного шага остаются следующие, агент обязан перейти к ним автоматически, без ожидания подтверждения пользователя.
1) Юридический аудит репозитория
   - Удалить из VCS чужие бинарники: `ru.cinimex.archimatetool.mcp/lib/Archi-5.6.0.zip`, мусор в `lib/tmp/` (если есть).
   - Проверить лицензии для `jackson-*` (Apache‑2.0) или запланировать миграцию на p2/Orbit.
   - Статус: [todo]
   - Сделано: —
   - Осталось: подготовить список к удалению/переносу, добавить ignore
2) Лицензия и уведомления
   - Выбрать лицензию проекта (рекомендуется Apache‑2.0; при необходимости совместимости — рассмотреть EPL‑2.0).
   - Добавить корневой `LICENSE` и при необходимости `NOTICE` (упоминание Jackson Apache‑2.0).
   - Статус: [todo]
   - Сделано: —
   - Осталось: финализировать выбор, добавить файлы
3) Чистка репозитория от чужих артефактов
   - Обновить `.gitignore` (исключить zips, бинарники, локальные кеши).
   - Очистить историю от `Archi-5.6.0.zip` (git filter‑repo/BFG) или вынести в отдельный закрытый артефакт‑хостинг.
   - Статус: [todo]
   - Сделано: —
   - Осталось: провести filter‑repo/BFG, проверить ссылки
4) Метаданные и лицензия в артефактах
   - Обновить `META-INF/MANIFEST.MF` (`Bundle-License` при возможности, `Bundle-Vendor`, `Bundle-Name`).
   - Проверить соответствие версий/диапазонов Archi 5.x.
   - Статус: [todo]
   - Сделано: —
   - Осталось: правки манифеста и проверка сборки
5) Документы сообщества
   - Добавить `CONTRIBUTING.md`, `CODE_OF_CONDUCT.md`, `SECURITY.md` (канал репортов), `GOVERNANCE.md` (опционально), `CODEOWNERS`.
   - Статус: [todo]
   - Сделано: —
   - Осталось: создать и согласовать тексты
6) Шаблоны GitHub
   - Добавить `.github/ISSUE_TEMPLATE/bug_report.yml`, `feature_request.yml`, `.github/pull_request_template.md`.
   - Заполнить описание репозитория, теги и топики.
   - Статус: [todo]
   - Сделано: —
   - Осталось: создать шаблоны
7) Документация
   - Обновить `README.md` (установка, ограничения локального сервиса, примеры REST/MCP).
   - Синхронизировать `AGENTS.md` с OSS‑сценарием; оставить правило синхронизации с `openapi.json`.
   - Добавить `RELEASING.md`, при необходимости `MAINTAINERS.md`.
   - Статус: [todo]
   - Сделано: —
   - Осталось: правки и вычитка
8) CI: базовая сборка и тесты
   - GitHub Actions: Java 17, сборка и запуск JUnit из `ru.cinimex.archimatetool.mcp/test` [[memory:5587551]].
   - Кэш Maven; публикация артефактов тест‑логов.
   - Статус: [todo]
   - Сделано: —
   - Осталось: добавить workflow
9) CI: статанализ и стиль
   - Включить `checkstyle`/`spotless` (минимальные правила) и отчёты в CI.
   - Статус: [todo]
   - Сделано: —
   - Осталось: конфигурации
10) Сборка и зависимости (эволюционно)
   - Вариант A (быстро): оставить `lib/jackson-*.jar` (Apache‑2.0), задокументировать в NOTICE.
   - Вариант B (целевой): мигрировать на Tycho/p2 (Orbit), убрать `lib/*.jar`, обновить `MANIFEST.MF`/`build.properties`.
   - Статус: [todo]
   - Сделано: —
   - Осталось: выбрать вариант, реализовать
11) Политика версионирования и релизы
   - SemVer; CHANGELOG (Keep a Changelog); GitHub Releases с артефактами.
   - При готовности — автосборка релиза (Tycho/Maven).
   - Статус: [todo]
   - Сделано: —
   - Осталось: настроить
12) Безопасность и раскрытие уязвимостей
   - `SECURITY.md`: канал связи и SLA на отклик.
   - Включить Dependabot (Maven) и Code Scanning (по возможности).
   - Статус: [todo]
   - Сделано: —
   - Осталось: конфигурации
13) Проверки соответствия REST/MCP
   - Убедиться, что `resources/openapi.json` актуален; синхронизировать описания MCP в `archi-mcp-server/server.py`.
   - Smoke (WSL, неинтерактивно): `GET /status`, `GET /openapi.json`, базовые CRUD.
   - Статус: [todo]
   - Сделано: —
   - Осталось: написать/прогнать smoke
14) Публичность репозитория
   - Проверить: история очищена, лицензия и документы на месте.
   - Сделать репозиторий публичным; включить branch protection.
   - Статус: [todo]
   - Сделано: —
   - Осталось: сменить видимость и политики

## DoD (Definition of Done)
- В корне: `LICENSE` (+ `NOTICE` при необходимости), документы сообщества, шаблоны GitHub, `CODEOWNERS`.
- Удалены чужие бинарники; история очищена; `.gitignore` обновлён.
- CI (JUnit) зелёный; smoke‑скрипт проходит; OpenAPI синхронизирован с MCP‑описаниями.
- Выпущен первый публичный релиз (tag + GitHub Release) с кратким CHANGELOG.

## Тестирование
- Юнит‑тесты: `ru.cinimex.archimatetool.mcp/test` (JUnit) — зелёные в CI [[memory:5587551]].
- Smoke (WSL): `GET /status`, `GET /openapi.json`, `/types`, базовые CRUD; без интерактива (curl+jq).
- Проверка лицензий: соответствие NOTICE/зависимостей; отсутствие чужих бинарников в Git.

## Риски/роллбэк
- Риск: несовместимость лицензий. Митигация: выбрать Apache‑2.0/EPL‑2.0 после верификации; при сомнениях отложить публикацию.
- Риск: удаление артефактов ломает сборку. Митигация: поэтапная миграция на p2/Tycho; чёткие инструкции в README.
- Риск: чувствительные файлы в истории. Митигация: предварительная очистка истории (filter‑repo/BFG), ревью перед публикацией.




