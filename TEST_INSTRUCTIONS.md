# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é MCP –ø–ª–∞–≥–∏–Ω–∞

## –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

### üß™ Unit-—Ç–µ—Å—Ç—ã
–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥ –±—ã–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ç–µ—Å—Ç—ã:

1. **`CoreBatchValidationTest.java`**
   - ‚ûï `addElementsToViewAcceptsStylesWithoutError()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å—Ç–∏–ª–µ–π
   
2. **`ScriptRunHttpHandlerTest.java`**
   - ‚ûï `testScriptExecutionErrorIncludesDetailedMessage()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤
   
3. **`ScriptEnginesHttpHandlerTest.java`**
   - ‚ûï `testMultipleEnginesSupported()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–≤–∏–∂–∫–æ–≤

### üî• Smoke-—Ç–µ—Å—Ç—ã
–û–±–Ω–æ–≤–ª–µ–Ω `test_smoke.py`:
- ‚ûï –¢–µ—Å—Ç —Å—Ç–∏–ª–µ–π –≤ `POST /views/{id}/add-element`
- ‚ûï –¢–µ—Å—Ç—ã —Å–∫—Ä–∏–ø—Ç–æ–≤: `GET /script/engines`, `POST /script/run`

## –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### Unit-—Ç–µ—Å—Ç—ã
```bash
# –í Eclipse/Archi —Å—Ä–µ–¥–µ - –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ –Ω–∞ test –ø–∞–ø–∫–µ ‚Üí Run As ‚Üí JUnit Test
```

### Smoke-—Ç–µ—Å—Ç—ã
```bash
cd archi-mcp-plugin/com.archimatetool.mcp/test/smoke
./run_smoke_py.sh
```

## –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∏–ª–µ–π –≤ addElementsToView
```json
{
  "elementId": "element-id",
  "bounds": {"x": 100, "y": 100, "width": 150, "height": 80},
  "style": {
    "fillColor": "#4CAF50",
    "fontColor": "#FFFFFF",
    "fontSize": "14",
    "opacity": "100"
  }
}
```

### 2. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤
- –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –≤ stderr
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–≤–∏–∂–∫–æ–≤ —Å–∫—Ä–∏–ø—Ç–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–≤–∏–∂–∫–æ–≤: ajs, groovy, jruby

### 3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ —á–µ—Ä–µ–∑ MCP
```json
{
  "code": "console.show(); console.log('Test'); visualObject.fillColor = '#FF0000';",
  "engine": "ajs",
  "timeoutMs": 5000
}
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–ª–∞–≥–∏–Ω–∞

1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `GET /script/engines` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{"installed": true, "engines": ["ajs"]}`
2. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–æ —Å—Ç–∏–ª—è–º–∏
3. ‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç —á–µ—Ä–µ–∑ `POST /script/run`
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Å–∫—Ä–∏–ø—Ç–µ

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

- **Unit-—Ç–µ—Å—Ç—ã**: –≤—Å–µ –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫
- **Smoke-—Ç–µ—Å—Ç—ã**: –≤—Å–µ —à–∞–≥–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–µ—Ä—à–∞—Ç—å—Å—è —É—Å–ø–µ—à–Ω–æ
- **–°—Ç–∏–ª–∏**: —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏
- **–°–∫—Ä–∏–ø—Ç—ã**: –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏ –ø—Ä–∏ —Å–±–æ—è—Ö


